
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	
<script type="text/javascript">
$(function(){
	if(vIsEdit){
	
		initInputNumber('#f-issu-contract-crud .text-number');
		dateInputFormat($('#f-issu-contract-crud').find('#ngay-ky'));
		dateInputFormat($('#f-issu-contract-crud').find('#ngay-tt'));
	}

	_gridSub01.kendoGrid({
		dataSource: {
			data: rowsTMP,
			pageSize: 999999,
			serverPaging: false,
			serverSorting: false,
           	serverFiltering: false
		},
		selectable: !vIsEdit, scrollable: true, 
		sortable: false,
		filterable: false, resizable: true,
		serverSorting: false,
		pageable: {
			refresh: false,
			pageSizes: false,
			numeric: false,
			previousNext: false
		},
		dataBinding: function () {
            record = (this.dataSource.page() - 1) * this.dataSource.pageSize();
        },
		columns: [
			{field: 'STT', title: 'STT', width: '50px', encoded: false, headerTemplate: '<a class="k-link" href="javascript:void(0);">STT</a>',
  				attributes: {'class': 'table-cell', style: 'text-align: right;'}, sortable: false, 
  				headerAttributes: {'class': 'table-header-cell', style: 'text-align: center;',}
			, template: '#= window.setTemplateForGrid("STT", data) #'
  				
  			},
  			{field: 'func', title: '', width: '50px', encoded: false, hidden: !vIsEdit
				, headerTemplate: '&nbsp;'
				, attributes: {'class': 'table-cell', style: 'text-align: center;'}, sortable: false
				, headerAttributes: {'class': 'table-header-cell', style: 'text-align: center;',}
				, template: '#= window.setTemplateForGrid("func", data) #'
			},
			{field: 'ProductName', title: '', width: '200px', encoded: false, headerTemplate: '<a class="k-link" href="javascript:void(0);">Tên hàng hóa, dịch vụ</a>',
				attributes: {'class': 'table-cell text-left text-nowrap'}, headerAttributes: {'class': 'table-header-cell text-center'},
				template: '#= window.setTemplateForGrid("ProductName", data) #'
			},
			
			
			{field: 'Quantity', title: '', width: '80px', encoded: false, headerTemplate: '<a class="k-link" href="javascript:void(0);">Số lượng</a>',
				attributes: {'class': 'table-cell text-right text-nowrap'}, headerAttributes: {'class': 'table-header-cell text-center'},
				template: '#= window.setTemplateForGrid("Quantity", data) #'
			},
			{field: 'Price', title: '', width: '100px', encoded: false, headerTemplate: '<a class="k-link" href="javascript:void(0);">Đơn giá</a>',
				attributes: {'class': 'table-cell text-right text-nowrap'}, headerAttributes: {'class': 'table-header-cell text-center'},
				template: '#= window.setTemplateForGrid("Price", data) #'
			},
			{field: 'Total', title: '', width: '100px', encoded: false, headerTemplate: '<a class="k-link" href="javascript:void(0);">Thành tiền</a>',
				attributes: {'class': 'table-cell text-right text-nowrap'}, headerAttributes: {'class': 'table-header-cell text-center'},
				template: '#= window.setTemplateForGrid("Total", data) #'
			},
			{field: 'VATRate', title: '', width: '100px', encoded: false, headerTemplate: '<a class="k-link" href="javascript:void(0);">Thuế suất<br>GTGT(%)</a>',
				attributes: {'class': 'table-cell text-center text-nowrap'}, headerAttributes: {'class': 'table-header-cell text-center'},
				template: '#= window.setTemplateForGrid("VATRate", data) #'
			},
			{field: 'VATAmount', title: '', width: '100px', encoded: false, headerTemplate: '<a class="k-link" href="javascript:void(0);">Tiền thuế<br>GTGT</a>',
				attributes: {'class': 'table-cell text-right text-nowrap'}, headerAttributes: {'class': 'table-header-cell text-center'},
				template: '#= window.setTemplateForGrid("VATAmount", data) #'
			},
			{field: 'Amount', title: '', width: '100px', encoded: false, headerTemplate: '<a class="k-link" href="javascript:void(0);">Tổng tiền</a>',
				attributes: {'class': 'table-cell text-right text-nowrap'}, headerAttributes: {'class': 'table-header-cell text-center'},
				template: '#= window.setTemplateForGrid("Amount", data) #'
			},
			{field: 'Note', title: '', width: '200px', encoded: false, headerTemplate: '<a class="k-link" href="javascript:void(0);">Ghi chú</a>',
				attributes: {'class': 'table-cell text-left text-nowrap'}, headerAttributes: {'class': 'table-header-cell text-center'},
				template: '#= window.setTemplateForGrid("Note", data) #'
			},
		],
		dataBound: function(e) {
			initInputNumber('#f-issu-contract-crud #grid .input-grid-number');
			
			autoCompleteProducts(_gridSub01.find('tbody[role="rowgroup"]').find('tr[data-uid]').find('input[name="ProductName"]'), function(e){
				var $tr = _gridSub01.find('tbody[role="rowgroup"]').find('tr:eq(' + rowSelect + ')');
				$tr.find('input[name="ProductCode"]').val(e.Code);
				$tr.find('input[name="Note"]').val(e.Note);
				$tr.find('input[name="Price"]').val(e.Price);
				$tr.find('select[name="VATRate"]').val(e.VatRate);
				$tr.find('input[name="Quantity"]').trigger('keyup');
			});
			
//			rowSelect
			
			/*ACTION IN GRID*/
			_gridSub01.find('tbody[role="rowgroup"]').find('tr[data-uid]').undelegate('i[data-sub-action]', 'click');
			_gridSub01.find('tbody[role="rowgroup"]').find('tr[data-uid]').delegate('i[data-sub-action]', 'click', function(e){
				event.preventDefault();/*event.stopPropagation();*/
				
				var $obj = $(this);
				var $tr = $obj.closest('tr');
				var subAction = $obj.attr('data-sub-action');

				var indexRow = $tr.index();
				switch (subAction) {
				case 'delete':
					alertConfirm('Bạn có muốn xóa dòng ' + (indexRow + 1) + ' không?',
						function(e){
							var objDataJson = _gridSub01.data("kendoGrid").dataSource.data();
							if(indexRow < objDataJson.length && indexRow > -1){
								objDataJson.splice(indexRow, 1);
								_gridSub01.data("kendoGrid").dataSource.data(objDataJson);	
							}
							calcTotalAmount();
						},
						function(e){}
					)
					break;
				default:
					break;
				}
			});
			
			_gridSub01.find('tbody[role="rowgroup"]').undelegate('input[type="checkbox"][name="chkSTT"]', 'click');
			_gridSub01.find('tbody[role="rowgroup"]').delegate('input[type="checkbox"][name="chkSTT"]', 'click', function(e){
				setSTTinGrid();
				calcAmountInGrid($(this));
			});
			
			_gridSub01.find('tbody[role="rowgroup"]').undelegate('.input-grid-number, .input-grid-vatrate, .input-grid-feature, select[name="VATRate"], select[name="Feature"], input[name="ProductName"], input[name="ProductCode"], input[name="Note"]', 'change');
			_gridSub01.find('tbody[role="rowgroup"]').delegate('.input-grid-number, .input-grid-vatrate, .input-grid-feature, select[name="VATRate"], select[name="Feature"], input[name="ProductName"], input[name="ProductCode"], input[name="Note"]', 'change', function(e){
				calcAmountInGrid($(this));
				calcTotalAmount();
			});
			
			_gridSub01.find('tbody[role="rowgroup"]').undelegate('.input-grid-number, .input-grid-vatrate, .input-grid-feature', 'keyup');
			_gridSub01.find('tbody[role="rowgroup"]').delegate('.input-grid-number, .input-grid-vatrate, .input-grid-feature', 'keyup', function(e){
				var code = e.keyCode || e.which;
//				console.log(code)
				//9: Tab
				//16: Shift Tab
				if(code == 9 || code == 16) return;
				calcAmountInGrid($(this));
				calcTotalAmount();
			});
			/*END - ACTION IN GRID*/
			
		}
        
	});
	
	$('#f-issu-contract-crud').find('button[data-action]').click(function (event) {
		event.preventDefault();/*event.stopPropagation();*/
		var dataAction = $(this).data('action');
		
		var $obj = $(this);
		var objDataSend = null;
		
		switch (dataAction) {
		case 'add-to-grid':
			var objDataJson = _gridSub01.data("kendoGrid").dataSource.data();
			objDataJson.push({});
			_gridSub01.data("kendoGrid").dataSource.data(objDataJson);
			break;
		
		case 'back':
			location.reload();
			$('#divMainContent').show();
			$('#divSubContent').hide(function(){$(this).empty();});
			try{
				
				if($('#f-issu-contract').find('#grid').length > 0)
					$('#f-issu-contract').find('#grid').data("kendoGrid").dataSource.read();
			}catch(err){}
			break;
	
		case 'accept':
			objDataSend = getDataToSave();
			$.ajax({
				type: "POST",
				datatype: "json",
				url: ROOT_PATH + '/main/' + transactionMain + '/check-data-save',
				data: objDataSend,
				beforeSend: function(req) {
					initAjaxJsonRequest(req);
		        	showLoading();
				},
				success:function(res) {
					hideLoading();
					if(res.errorCode == 0) {
						var responseData = res.responseData;
						
						var confirmText = responseData['CONFIRM'];
						tokenTransaction = responseData['TOKEN'];
						
						objDataSend['tokenTransaction'] = tokenTransaction;
						alertConfirm(confirmText,
							function(e){
								$.ajax({
									type: "POST",
									datatype: "json",
									url: ROOT_PATH + '/main/' + transactionMain + '/save-data',
									data: objDataSend,
									beforeSend: function(req) {
										initAjaxJsonRequest(req);
							        	showLoading();
									},
									success:function(res) {
										hideLoading();
										if(res) {
											if(res.errorCode == 0) {
												//window.location.href='/hddt/main/issu-contract/init';
												$('#f-issu-contract-crud').find('button[data-action="back"]').trigger('click');
												location.reload();
											}else{
												alertDLSuccess(createObjectError(res).html(), function(){});
											}
										}else{
											alertDLSuccess('unknown error!!!', function(){});
											hideLoading();
										}
									},
									error:function (xhr, ajaxOptions, thrownError){
										alertDLSuccess(xhr.status + " - " + xhr.responseText, function(){});
							            hideLoading();
							        }
								});
							},
							function(e){}
						);
					}else{
						alertDLSuccess(createObjectError(res).html(), function(){});
					}
				},
				error:function (xhr, ajaxOptions, thrownError){
					$obj.prop('disabled', false);
					alertDLSuccess(xhr.status + " - " + xhr.responseText, function(){});
		            hideLoading();
		        }
			});
			break;
		default:
			break;
		}
	});
	
});

function setTemplateForGrid(key, data){
	if(!vIsEdit) return data[key] == null? '': data[key];
	
	var text = '';
	if('func' == key){
		text = '<div>';
		text += '<i class="mdi mdi-close-box fs-25 text-black c-pointer" data-sub-action="delete"></i>';
		text += '</div>';
		return text;
	}
	
	var isReadonlyOrDisabled = false;
	var feature = data['Feature'];
	var objVAT123 = {'0': '0%', '5': '5%', '7': '10%x70%', '8': '8%', '10': '10%', '-1': 'KCT', '-2': 'KKKNT'};
	var _valTmp = '';
	text = '<div class="form-row m-l-1 m-r-1">';
	switch (key) {
	case 'Quantity':
	case 'Price':
	case 'Total':
	case 'VATAmount':
	case 'Amount':
		text = '<input type="text" name="' + key + '" value="' + (null == data[key]? '': data[key]) + '" class="input-grid k-input form-control form-control-sm text-right input-grid-number" ' + (('2' == feature)? ' readonly="readonly" ': '') + ' >';	// || '4' == feature
		break;
	
	case 'VATRate':
		_valTmp = null == data[key]? '': data[key];
		if('' == _valTmp) _valTmp = '10';
		
		text += '<select class="input-grid form-control form-control-sm input-grid-vatrate"  name="' + key + '" style="height: 100%;" ' + (('2' == feature)? ' disabled="disabled" ': '') + '>';	/*|| '4' == feature*/
		$.each(objVAT123, function(k, v){
			text += '<option value="' + k + '" ' + (k == _valTmp? 'selected="selected" ': '') + '>' + v + '</option>';
		});
		text += '</select>';
		break;
	
	case 'STT':
		text += '<div class="input-group">';
		text += '	<div class="input-group-prepend">';		
		text += '		<label class="custom-control custom-checkbox">';
		text += '			<input type="checkbox" name="chkSTT" class="custom-control-input" ' + (null != data[key] && '' != data[key]? 'checked="checked"': '') + ' >';
		text += '			<span class="custom-control-label">&nbsp;</span>';
		text += '		</label>';		
		text += '	</div>';
		text += '	<input type="text" name="' + key + '" value="' + (null == data[key]? '': data[key]) + '" class="input-grid k-input form-control form-control-sm text-right" style="border: none;" >';
		text += '</div>';
		break;
	default:
		text = '<input type="text" name="' + key + '" value="' + (null == data[key]? '': data[key]) + '" class="input-grid k-input form-control form-control-sm" >';
		break;
	}
	text += '</div>';
	return text;
}

function calcAmountInGrid($obj){
	var $tr = $obj.closest('tr');
	var _name = $obj.prop('name');
	var _val = '';
	var _numeral = null;
	var loai_tien_tt = $('#f-issu-contract-crud').find('#loai-tien-tt').val();
	
	var dblQuantity = 0;
	var dblPrice = 0;
	var dblTotal = 0;
	var dblVATRate = 0;
	var dblVATAmount = 0;
	var dblAmount = 0;
	
	switch (_name) {
	case 'chkSTT':
//		if('' == _val){
//			$tr.find('input[type="checkbox"][name="chkSTT"]').prop('checked', false);
//		}else{
//			$tr.find('input[type="checkbox"][name="chkSTT"]').prop('checked', true);
//		}
		break;
	case 'Quantity':
	case 'Price':
		_numeral = numeral($tr.find('input[name="Quantity"]').val());
		dblQuantity = _numeral == null? 0: _numeral.value();
		_numeral = numeral($tr.find('input[name="Price"]').val());
		dblPrice = _numeral == null? 0: _numeral.value();
		dblTotal = dblQuantity * dblPrice;
		
		$tr.find('input[name="Total"]').val(dblTotal.toFixed(4))
		FormatCurrency($tr.find('input[name="Total"]')[0], loai_tien_tt);
		
		_numeral = numeral($tr.find('select[name="VATRate"]').val());
		dblVATRate = _numeral == null? 0: _numeral.value();
		if(dblVATRate < 0) dblVATRate = 0;
		
		dblVATAmount = dblTotal * dblVATRate / 100;
		$tr.find('input[name="VATAmount"]').val(dblVATAmount.toFixed(4))
		FormatCurrency($tr.find('input[name="VATAmount"]')[0], loai_tien_tt);
		break;
	case 'Total':

		_numeral = numeral($tr.find('input[name="Total"]').val());
		dblTotal = _numeral == null? 0: _numeral.value();
		
		_numeral = numeral($tr.find('select[name="VATRate"]').val());
		dblVATRate = _numeral == null? 0: _numeral.value();
		if(dblVATRate < 0) dblVATRate = 0;
		
		dblVATAmount = dblTotal * dblVATRate / 100;
		$tr.find('input[name="VATAmount"]').val(dblVATAmount.toFixed(4));
		FormatCurrency($tr.find('input[name="VATAmount"]')[0], loai_tien_tt);
		break;
	case 'VATRate':
		_numeral = numeral($tr.find('input[name="Total"]').val());
		dblTotal = _numeral == null? 0: _numeral.value();
		
		_numeral = numeral($tr.find('select[name="VATRate"]').val());
		dblVATRate = _numeral == null? 0: _numeral.value();
		if(dblVATRate < 0) dblVATRate = 0;
		
		dblVATAmount = dblTotal * dblVATRate / 100;
		$tr.find('input[name="VATAmount"]').val(dblVATAmount.toFixed(4));
		FormatCurrency($tr.find('input[name="VATAmount"]')[0], loai_tien_tt);
		break;
	case 'VATAmount':
		_numeral = numeral($tr.find('input[name="Total"]').val());
		dblTotal = _numeral == null? 0: _numeral.value();
		
		_numeral = numeral($tr.find('input[name="VATAmount"]').val());
		dblVATAmount = _numeral == null? 0: _numeral.value();
		break;
	case 'Feature':
		$tr.find('input[name="Note"], input[name="Quantity"], input[name="Price"], input[name="Total"], input[name="VATRate"], input[name="VATAmount"], input[name="Amount"]').prop('readonly', false);
		$tr.find('select[name="VATRate"]').prop('disabled', false);
		$tr.find('select[name="VATRate"]').val('0');
		_val = $obj.val();
		switch (_val) {
		case '1':
			$tr.find('input[name="VATAmount"], input[name="Amount"]').val('');
			break;
		case '2':
			$tr.find('input[name="Price"]').val('');
			$tr.find('input[name="Total"], select[name="VATRate"], input[name="VATAmount"]').val('');
			
			$tr.find('input[name="Price"], input[name="Total"], input[name="VATAmount"], input[name="Amount"]').prop('readonly', true);
			$tr.find('select[name="VATRate"]').prop('disabled', true);
			break;
		case '4':
			$tr.find('input[name="Note"], input[name="Quantity"], input[name="Price"]').val('');
			$tr.find('input[name="Total"], select[name="VATRate"], input[name="VATAmount"]').val('');
			
//			$tr.find('input[name="Note"], input[name="Quantity"], input[name="Price"], input[name="Total"], input[name="VATRate"], input[name="VATAmount"], input[name="Amount"]').prop('readonly', true);
//			$tr.find('select[name="VATRate"]').prop('disabled', true);
			
			break;
		default:
			break;
		}
		break;
	case 'ProductName':
		_val = $obj.val();
		if('' == _val){
			$tr.find('input[type="checkbox"][name="chkSTT"]').prop('checked', false);
		}else{
			$tr.find('input[type="checkbox"][name="chkSTT"]').prop('checked', true);
		}
		setSTTinGrid();
		break;
	default:
		break;
	}
	
	_numeral = numeral($tr.find('input[name="Total"]').val());
	dblTotal = _numeral == null? 0: _numeral.value();
	_numeral = numeral($tr.find('input[name="VATAmount"]').val());
	dblVATAmount = _numeral == null? 0: _numeral.value();
	
	dblAmount = dblTotal + dblVATAmount;
	$tr.find('input[name="Amount"]').val(dblAmount.toFixed(4))
	FormatCurrency($tr.find('input[name="Amount"]')[0], loai_tien_tt);
	
	/*LAY THONG TIN UPDATE LAI DATASOURCE*/
	var objDataJson = _gridSub01.data("kendoGrid").dataSource.data();
	try{
		var indexRow = $tr.index();
		var rowData = objDataJson[indexRow];
		
		rowData['STT'] = $tr.find('input[name="STT"]').val();
		rowData['ProductName'] = $tr.find('input[name="ProductName"]').val();
		rowData['Quantity'] = $tr.find('input[name="Quantity"]').val();
		rowData['Price'] = $tr.find('input[name="Price"]').val();
		rowData['Total'] = $tr.find('input[name="Total"]').val();
		rowData['VATRate'] = $tr.find('select[name="VATRate"]').val();
		rowData['VATAmount'] = $tr.find('input[name="VATAmount"]').val();
		rowData['Amount'] = $tr.find('input[name="Amount"]').val();
		rowData['Note'] = $tr.find('input[name="Note"]').val();
		_gridSub01.data("kendoGrid").dataSource.data()[indexRow] = rowData;
	}catch(err){
		console.log(err);
	}
}

function setSTTinGrid(){
	var $tr = null;
	var stt = 0;
	_gridSub01.find('table[role="grid"]').find('tbody[role="rowgroup"]').find('tr').each(function(i, v) {
		$tr = $(this);
		if($tr.find('input[type="checkbox"][name="chkSTT"]').prop('checked')
			&& $tr.find('input[type="text"][name="ProductName"]').val() != ''
		){
			$tr.find('input[type="text"][name="STT"]').val(++stt);
		}else{
			$tr.find('input[type="text"][name="STT"]').val('');
		}
	});
}

function calcTotalAmount(){
	var loai_tien_tt = $('#f-issu-contract-crud').find('#loai-tien-tt').val();
	var objDataJson = _gridSub01.data("kendoGrid").dataSource.data();
	
	/*TINH TIEN TRUOC THUE - TIEN THUE - TONG TIEN SAU THUE*/
	var sumAmount = 0;
	var sumAmountVAT = 0;
	var sumAmountAfterTax = 0;
	var tmp = '';
	var tmp2 = '';
	jQuery.each(objDataJson, function(index, item) {
		tmp = item['ProductName'] == null? '': item['ProductName'].trim();
		if('' != tmp){
			_val = item['Feature'] == null? '': item['Feature'].trim();
			_numeral = numeral(item['Total']);
			if(_val == '3'){ //CK
				sumAmount -= _numeral.value() == null? 0: _numeral.value();
			}else{
				sumAmount += _numeral.value() == null? 0: _numeral.value();
			}
			
			switch (_val) {
			case '4':		//GHI CHU - KHONG XU LY TIEN
				break;
			case '3':		//CK: TRU TIEN THUE VA TONG TIEN
				_numeral = numeral(item['VATAmount']);
				sumAmountVAT -= _numeral.value() == null? 0: _numeral.value();
				_numeral = numeral(item['Amount']);
				sumAmountAfterTax -= _numeral.value() == null? 0: _numeral.value();
				break;
			case '2':		//KM: CHI CONG TONG TIEN
				break;
			default:
				_numeral = numeral(item['VATAmount']);
				sumAmountVAT += _numeral.value() == null? 0: _numeral.value();
				_numeral = numeral(item['Amount']);
				sumAmountAfterTax += _numeral.value() == null? 0: _numeral.value();
				break;
			}
		}
	});
	
	$('#f-issu-contract-crud').find('#tong-tien-truoc-thue').val(sumAmount.toFixed(4))
	FormatCurrency($('#f-issu-contract-crud').find('#tong-tien-truoc-thue')[0], loai_tien_tt);
	$('#f-issu-contract-crud').find('#tong-tien-thue-gtgt').val(sumAmountVAT.toFixed(4))
	FormatCurrency($('#f-issu-contract-crud').find('#tong-tien-thue-gtgt')[0], loai_tien_tt);
	$('#f-issu-contract-crud').find('#tong-tien-da-co-thue').val(sumAmountAfterTax.toFixed(4))
	FormatCurrency($('#f-issu-contract-crud').find('#tong-tien-da-co-thue')[0], loai_tien_tt);
	
	$('#f-issu-contract-crud').find('#tien-bang-chu').val(readMoneyInWords(Math.abs(sumAmountAfterTax.toFixed(4)), loai_tien_tt));
}

function getDataToSave(){
	var dataPost = {};
	dataPost['_id'] = $('#f-issu-contract-crud').find('input[name="_id"]').val();
	dataPost['n'] = $('#f-issu-contract-crud').find('#n').val();
	dataPost['e'] = $('#f-issu-contract-crud').find('#e').val();
	dataPost['t'] = $('#f-issu-contract-crud').find('#t').val();
	dataPost['boss'] = $('#f-issu-contract-crud').find('#boss').val();
	dataPost['p'] = $('#f-issu-contract-crud').find('#p').val();
	dataPost['a'] = $('#f-issu-contract-crud').find('#a').val();
	dataPost['shd'] = $('#f-issu-contract-crud').find('#shd').val();
	dataPost['slhd'] = $('#f-issu-contract-crud').find('#slhd').val();
	dataPost['ngay-ky'] = $('#f-issu-contract-crud').find('#ngay-ky').val();
	dataPost['ngay-tt'] = $('#f-issu-contract-crud').find('#ngay-tt').val();
	
	dataPost['cv'] = $('#f-issu-contract-crud').find('#cv').val();
	dataPost['e'] = $('#f-issu-contract-crud').find('#e').val();
	dataPost['w'] = $('#f-issu-contract-crud').find('#w').val();
	dataPost['ac'] = $('#f-issu-contract-crud').find('#ac').val();
	dataPost['an'] = $('#f-issu-contract-crud').find('#an').val();	
	dataPost['bn'] = $('#f-issu-contract-crud').find('#bn').val();
	
	
	dataPost['gc'] = $('#f-issu-contract-crud').find('#gc').val();
	dataPost['hinh-thuc-thanh-toan'] = $('#f-issu-contract-crud').find('#hinh-thuc-thanh-toan').val();
	dataPost['hinh-thuc-thanh-toan-text'] = $('#f-issu-contract-crud').find('#hinh-thuc-thanh-toan').find('option:selected').text();
	
	dataPost['km'] = $('#f-issu-contract-crud').find('#km').val();
	
	dataPost['tong-tien-truoc-thue'] = $('#f-issu-contract-crud').find('#tong-tien-truoc-thue').val();
	dataPost['tong-tien-thue-gtgt'] = $('#f-issu-contract-crud').find('#tong-tien-thue-gtgt').val();
	dataPost['tong-tien-da-co-thue'] = $('#f-issu-contract-crud').find('#tong-tien-da-co-thue').val();
	dataPost['tien-bang-chu'] = $('#f-issu-contract-crud').find('#tien-bang-chu').val();
	var arrRows = [];
	var objDataJson = _gridSub01.data("kendoGrid").dataSource.data();
	jQuery.each(objDataJson, function(index, item) {
		tmp = item['ProductName'] == null? '': item['ProductName'].trim();
		if('' != tmp){
			arrRows.push(item);
		}
	});
	dataPost['ds-san-pham'] = encodeObjJsonBase64UTF8(arrRows);
	return dataPost;
	
	
}
</script>
<!-- <script th:src="@{/static/issu-contract/einvoice-crudA.js.download}"></script> -->
<!-- <script th:src="@{/static/issu-contract/einvoice-crudB.js.download}"></script> -->

<div class="row page-titles">
	<div class="col-12 align-self-center p-l-0 centerX">
		<h3 class="text-themecolor m-b-0 m-t-0 text-uppercase"
			th:text="${_header_}"></h3>
	</div>
</div>
<div class="container-fluid hide style-main-content" id="divSubContent"
	style="display: block">
	

	<div class="row">
		<div class="col-12">
					<form id="f-issu-contract-crud" name="f-issu-contract-crud" method="post" enctype="multipart/form-data">
				<div class="card">
					<div class="card-body">
						<div class="row m-b-16">
							<div class="col-12">
								<span
									class="text-middle fw-800 text-uppercase text-decoration-underline color-ses">THÔNG
									TIN KHÁCH HÀNG </span>
							</div>
						</div>
						<div class="form-group">
							<div class="row">
								<div class="col-12 col-sm-12 col-md-6">
									<div class="row">
										<div class="col-12 custom-field m-b-16">
											<div class="c-f__wrapper">
										
						<input type="hidden" id="cv" th:value="${Position}" >
							<input type="hidden" id="e" th:value="${Email}" >
								<input type="hidden" id="w" th:value="${Website}" >
									<input type="hidden" id="ac" th:value="${AccountNumber}" >
										<input type="hidden" id="an" th:value="${AccountName}" >
											<input type="hidden" id="bn" th:value="${BankName}" >
				
													
									<input class="form-control form-control-sm c-f__textbox"
													type="text" autocomplete="off" id="t" name="t" 
													th:value="${TaxCode}" readonly  />
													
										
													
											<fieldset aria-hidden="true" class="c-f__set">
											
													<legend class="c-f__legend">
														<label>Mã số thuế</label>
													</legend>
												</fieldset>
											</div>
										</div>
									</div>
									<div class="row">
										<div class="col-12 col-sm-12 col-md-6 custom-field m-b-16">
											<div class="c-f__wrapper">
												<input class="form-control form-control-sm c-f__textbox"
													type="text" autocomplete="off" id="n" name="n" readonly
													th:value="${Name}"   />
												<fieldset aria-hidden="true" class="c-f__set">
													<legend class="c-f__legend">
														<label>Tên khách hàng</label>
													</legend>
												</fieldset>
											</div>
										</div>
										<div class="col-12 col-sm-12 col-md-6 custom-field m-b-16">
											<div class="c-f__wrapper">
												<input class="form-control form-control-sm c-f__textbox"
													type="text" autocomplete="off" id="boss" name="boss" readonly
													th:value="${MainUser}"   />
												<fieldset aria-hidden="true" class="c-f__set">
													<legend class="c-f__legend">
														<label>Người đại diện</label>
													</legend>
												</fieldset>
											</div>
										</div>
									</div>
								</div>
								<div class="col-12 col-sm-12 col-md-6">
									<div class="row">
										<div class="col-12 custom-field m-b-16">
											<div class="c-f__wrapper">
												<input class="form-control form-control-sm c-f__textbox"
													type="text" autocomplete="off" id="p" name="p" readonly
													th:value="${Phone}"  />
												<fieldset aria-hidden="true" class="c-f__set">
													<legend class="c-f__legend">
														<label>Điện thoại</label>
													</legend>
												</fieldset>
											</div>
										</div>
									</div>
									<div class="row">
										<div class="col-12 custom-field m-b-16">
											<div class="c-f__wrapper">
												<input class="form-control form-control-sm c-f__textbox"
													type="text" autocomplete="off" id="a" name="a" readonly
													th:value="${Address}"  />
												<fieldset aria-hidden="true" class="c-f__set">
													<legend class="c-f__legend">
														<label>Địa chỉ</label>
													</legend>
												</fieldset>
											</div>
										</div>
									</div>
								</div>
							</div>
							<div class="row m-b-16">
								<div class="col-12">
									<span
										class="text-middle fw-800 text-uppercase text-decoration-underline color-ses">THÔNG
										TIN HỢP ĐỒNG </span>
								</div>
							</div>
							<div class="row">
								<div class="col-12 col-sm-12 col-md-6">

									<div class="row">
										<div class="col-12 col-sm-12 col-md-8 custom-field m-b-16">
											<div class="c-f__wrapper">
												<input class="form-control form-control-sm c-f__textbox"
											th:value="${SHDon}" th:readonly="${!_isedit_}"		type="text" autocomplete="off" id="shd" name="shd" />
												<fieldset aria-hidden="true" class="c-f__set">
													<legend class="c-f__legend">
														<label>Số hợp đồng <span class="text-danger" style="font-size:15px"> (*)</span></label>
													</legend>
												</fieldset>
											</div>
										</div>
										
										<div class="col-12 col-sm-12 col-md-4 custom-field m-b-16">
											<div class="c-f__wrapper">
													<input class="form-control form-control-sm c-f__textbox"
												th:value="${SLHDon}" th:readonly="${!_isedit_}"		type="text" autocomplete="off" id="slhd" name="slhd" />
												<fieldset aria-hidden="true" class="c-f__set">
													<legend class="c-f__legend">
														<label>Số lượng hóa đơn <span class="text-danger" style="font-size:15px"> (*)</span></label>
													</legend>
												</fieldset>
											</div>
										</div>
									</div>
								</div>
								<div class="col-12 col-sm-12 col-md-6">
									<div class="row">
										<div class="col-12 col-sm-12 col-md-6">
											<div class="custom-field m-b-16">
												<div class="c-f__wrapper">
													<input class="form-control form-control-sm c-f__textbox"
														th:value="${NgayKy}" th:readonly="${!_isedit_}"	type="text" id="ngay-ky" name="ngay-ky"
														autocomplete="off" />
													<fieldset aria-hidden="true" class="c-f__set">
														<legend class="c-f__legend">
															<label>Ngày ký <span class="text-danger" style="font-size:15px"> (*)</span></label>
														</legend>
													</fieldset>
												</div>
											</div>
										</div>
										<div class="col-12 col-sm-12 col-md-6">
											<div class="custom-field m-b-16">
												<div class="c-f__wrapper">
													<input class="form-control form-control-sm c-f__textbox"
													th:value="${NgayThanhToan}" th:readonly="${!_isedit_}"		type="text" id="ngay-tt" name="ngay-tt"
														autocomplete="off" />
													<fieldset aria-hidden="true" class="c-f__set">
														<legend class="c-f__legend">
															<label>Ngày thanh toán </label>
														</legend>
													</fieldset>
												</div>
											</div>
										</div>
									</div>
								</div>
								
								
							</div>
							
									<div class="row">
										<div class="col-12 col-sm-12 col-md-6 custom-field m-b-16">
											<div class="c-f__wrapper">
												<input class="form-control form-control-sm c-f__textbox"
										th:value="${GhiChu}" th:readonly="${!_isedit_}"		id="gc" name="gc"	type="text" autocomplete="off"/>
												<fieldset aria-hidden="true" class="c-f__set">
													<legend class="c-f__legend">
														<label>Ghi chú</label>
													</legend>
												</fieldset>
											</div>
										</div>
										<div class="col-12 col-sm-12 col-md-6 custom-field m-b-16">
													<div class="row">
										<div class="col-12 col-sm-12 col-md-6">
											<div class="custom-field m-b-16">
												<div class="c-f__wrapper">
												
								
										 
										 	<input class="form-control form-control-sm c-f__textbox" th:value="${HTTToan}" th:readonly="true" th:if="${!_isedit_}" type="text" autocomplete="off"  />
									<select class="form-control form-control-sm c-f__textbox" id="hinh-thuc-thanh-toan" name="hinh-thuc-thanh-toan" th:if="${_isedit_}" >
										<option value=""></option>
										<th:block th:if="${map_paymenttype != null}" >
											<option th:each="entry : ${map_paymenttype.entrySet()}"
												th:value="${entry.key}" th:utext="${entry.value}" th:selected="${HTTToanCode == entry.key}" > </option>
										</th:block>
									</select>
									
									
									
									
													<fieldset aria-hidden="true" class="c-f__set">
														<legend class="c-f__legend">
															<label>Hình thức thanh toán <span class="text-danger" style="font-size:15px"> (*)</span></label>
														</legend>
													</fieldset>
												</div>
											</div>
										</div>
										<div class="col-12 col-sm-12 col-md-6">
											<div class="custom-field m-b-16">
												<div class="c-f__wrapper">
													<input class="form-control form-control-sm c-f__textbox"
													th:value="${KhuyenMai}" th:readonly="${!_isedit_}"		type="text" id="km" name="km"
														autocomplete="off" />
													<fieldset aria-hidden="true" class="c-f__set">
														<legend class="c-f__legend">
															<label>Khuyến mãi</label>
														</legend>
													</fieldset>
												</div>
											</div>
										</div>
									</div>
							
										</div>
									</div>
						
							
							<div class="row m-b-16">
								<div class="col-12">
									<span
										class="text-middle fw-800 text-uppercase text-decoration-underline color-ses">THÔNG
										TIN IN HỢP ĐỒNG </span>
								</div>
							</div>
							<div class="row">
								<div class="col-12 col-sm-12 col-md-6 m-b-16">
									<div class="text-middle fw-800 text-uppercase m-b-16">
										BÊN SỬ DỤNG DỊCH VỤ (BÊN A)</div>
									<div class="col-12 p-0 has-min-height-grid-prd">
										<div id="gridA" data-role="grid" class="k-grid k-widget"
											style="">
											<div class="k-grid-header" style="padding-right: 7px;">
												<div class="k-grid-header-wrap k-auto-scrollable"
													data-role="resizable">
													<table role="grid">
														<colgroup>
															<col style="width: 45px">
															<col style="width: 80px">
															<col style="width: 180px">
														</colgroup>
														<thead role="rowgroup">
															<tr role="row">
																<th role="columnheader" data-field="STT" rowspan="1"
																	data-title="STT" data-index="0"
																	id="08a4a291-64b2-4643-b3d7-84753212f86d"
																	class="table-header-cell k-header"
																	style="text-align: center;"><a class="k-link"
																	href="javascript:void(0);">STT</a></th>
																<th role="columnheader" data-field="fieldName"
																	rowspan="1" data-title="Invoice Number" data-index="1"
																	id="d763b566-ffa9-4668-b3ca-778f20d41efe"
																	class="table-header-cell k-header"
																	style="text-align: center;"><a class="k-link"
																	href="javascript:void(0);">Trường dữ liệu</a></th>
																<th role="columnheader" data-field="fieldValue"
																	rowspan="1" data-title="Out Date" data-index="2"
																	id="1fd2acb9-17e7-4c24-b0c9-3b06310fc6cd"
																	class="table-header-cell k-header"
																	style="text-align: center;"><a class="k-link"
																	href="javascript:void(0);">Giá trị</a></th>
															</tr>
														</thead>
													</table>
												</div>
											</div>
											<div class="k-grid-content">
												<table role="grid">
													<colgroup>
														<col style="width: 45px">
														<col style="width: 80px">
														<col style="width: 180px">
													</colgroup>
															<tbody role="rowgroup">
														<tr data-uid="33b05862-2c54-4505-a50e-0d6003f73c91"
															role="row">
															<td class="table-cell" style="text-align: right;"
																role="gridcell">1</td>
															<td class="table-cell" style="text-align: center;"
																role="gridcell">Tên Công Ty</td>
															<td class="table-cell" style="text-align: center;"
																role="gridcell" th:text="${Name}" ></td>
														</tr>
														<tr class="k-alt"
															data-uid="ea4a6378-536c-495d-b30e-16038bfd2201"
															role="row">
															<td class="table-cell" style="text-align: right;"
																role="gridcell">2</td>
															<td class="table-cell" style="text-align: center;"
																role="gridcell">Mã Sô Thuế</td>
															<td class="table-cell" style="text-align: center;"
																role="gridcell" th:text="${TaxCode}" ></td>
														</tr>
														<tr data-uid="32da1104-e2a7-4496-80e6-03c33082469f"
															role="row">
															<td class="table-cell" style="text-align: right;"
																role="gridcell">3</td>
															<td class="table-cell" style="text-align: center;"
																role="gridcell">Người Đại Diện</td>
															<td class="table-cell" style="text-align: center;"
																role="gridcell"th:text="${MainUser}"></td>
														</tr>
														<tr class="k-alt"
															data-uid="65367b3b-d5ad-4618-a65a-07aab21e2103"
															role="row">
															<td class="table-cell" style="text-align: right;"
																role="gridcell">4</td>
															<td class="table-cell" style="text-align: center;"
																role="gridcell">Chức Vụ</td>
															<td class="table-cell" style="text-align: center;"
																role="gridcell" th:text="${Position}"></td>
														</tr>
														<tr data-uid="c704b977-99d8-47bd-8bf9-8598d507bbba"
															role="row">
															<td class="table-cell" style="text-align: right;"
																role="gridcell">5</td>
															<td class="table-cell" style="text-align: center;"
																role="gridcell">Số Tài Khoản</td>
															<td class="table-cell" style="text-align: center;"
																role="gridcell"th:text="${AccountNumber}"></td>
														</tr>
														<tr class="k-alt" data-uid="65367b3b-d5ad-4618-a65a-07aab21e2102"
															role="row">
															<td class="table-cell" style="text-align: right;"
																role="gridcell">6</td>
															<td class="table-cell" style="text-align: center;"
																role="gridcell">Tên Tài Khoản</td>
															<td class="table-cell" style="text-align: center;"
																role="gridcell"th:text="${AccountName}"></td>
														</tr>
														<tr  data-uid="65367b3b-d5ad-4618-a65a-07aab21e2102"
															role="row">
															<td class="table-cell" style="text-align: right;"
																role="gridcell">7</td>
															<td class="table-cell" style="text-align: center;"
																role="gridcell">Tại Ngân Hàng</td>
															<td class="table-cell" style="text-align: center;"
																role="gridcell"th:text="${BankName}"></td>
														</tr>
														<tr class="k-alt" data-uid="65367b3b-d5ad-4618-a65a-07aab21e2102"
															role="row">
															<td class="table-cell" style="text-align: right;"
																role="gridcell">8</td>
															<td class="table-cell" style="text-align: center;"
																role="gridcell">Website</td>
															<td class="table-cell" style="text-align: center;"
																role="gridcell"th:text="${Website}"></td>
														</tr>
															<tr data-uid="65367b3b-d5ad-4618-a65a-07aab21e2102"
															role="row">
															<td class="table-cell" style="text-align: right;"
																role="gridcell">9</td>
															<td class="table-cell" style="text-align: center;"
																role="gridcell">Địa Chỉ Giao Dịch</td>
															<td class="table-cell" style="text-align: center;"
																role="gridcell"th:text="${Address}"></td>
														</tr>
														<tr class="k-alt" data-uid="65367b3b-d5ad-4618-a65a-07aab21e2102"
															role="row">
															<td class="table-cell" style="text-align: right;"
																role="gridcell">10</td>
															<td class="table-cell" style="text-align: center;"
																role="gridcell">Địa Chỉ Xuất Hóa Đơn</td>
														<td class="table-cell" style="text-align: center;"
																role="gridcell"th:text="${Address}"></td>
														</tr>
															<tr data-uid="65367b3b-d5ad-4618-a65a-07aab21e2102"
															role="row">
															<td class="table-cell" style="text-align: right;"
																role="gridcell">11</td>
															<td class="table-cell" style="text-align: center;"
																role="gridcell">Điện Thoại</td>
															<td class="table-cell" style="text-align: center;"
																role="gridcell"th:text="${Phone}"></td>
														</tr>
															<tr class="k-alt" data-uid="65367b3b-d5ad-4618-a65a-07aab21e2102"
															role="row">
															<td class="table-cell" style="text-align: right;"
																role="gridcell">12</td>
															<td class="table-cell" style="text-align: center;"
																role="gridcell">Email</td>
															<td class="table-cell" style="text-align: center;"
																role="gridcell"th:text="${Email}"></td>
														</tr>
											
													</tbody>
												</table>
											</div>
											<div class="k-pager-wrap k-grid-pager k-widget k-floatwrap"
												data-role="pager">
												<span class="k-pager-info k-label">1 - 12 of 12 items</span>
											</div>
										</div>
									</div>
								</div>


								<div class="col-12 col-sm-12 col-md-6">
									<div class="text-middle fw-800 text-uppercase m-b-16">
										BÊN CUNG CẤP DỊCH VỤ (BÊN B)</div>
									<div class="col-12 p-0 has-min-height-grid-prd">
										<div id="gridB" data-role="grid" class="k-grid k-widget"
											style="">
											<div class="k-grid-header" style="padding-right: 7px;">
												<div class="k-grid-header-wrap k-auto-scrollable"
													data-role="resizable">
													<table role="grid">
														<colgroup>
															<col style="width: 45px">
															<col style="width: 80px">
															<col style="width: 180px">
														</colgroup>
														<thead role="rowgroup">
															<tr role="row">
																<th role="columnheader" data-field="STT" rowspan="1"
																	data-title="STT" data-index="0"
																	id="1e7f5f4f-4a68-4234-b530-3e4709d7aab3"
																	class="table-header-cell k-header"
																	style="text-align: center;"><a class="k-link"
																	href="javascript:void(0);">STT</a></th>
																<th role="columnheader" data-field="fieldName"
																	rowspan="1" data-title="Invoice Number" data-index="1"
																	id="a5157c21-51d7-4080-9424-34c1465a25aa"
																	class="table-header-cell k-header"
																	style="text-align: center;"><a class="k-link"
																	href="javascript:void(0);">Trường dữ liệu</a></th>
																<th role="columnheader" data-field="fieldValue"
																	rowspan="1" data-title="Out Date" data-index="2"
																	id="3389dd8f-861a-47df-9a37-e5bf8c1b3747"
																	class="table-header-cell k-header"
																	style="text-align: center;"><a class="k-link"
																	href="javascript:void(0);">Giá trị</a></th>
															</tr>
														</thead>
													</table>
												</div>
											</div>
											<div class="k-grid-content">
												<table role="grid">
													<colgroup>
														<col style="width: 45px">
														<col style="width: 80px">
														<col style="width: 180px">
													</colgroup>
													<tbody role="rowgroup">
														<tr data-uid="33b05862-2c54-4505-a50e-0d6003f73c91"
															role="row">
															<td class="table-cell" style="text-align: right;"
																role="gridcell">1</td>
															<td class="table-cell" style="text-align: center;"
																role="gridcell">Tên Công Ty</td>
															<td class="table-cell" style="text-align: center;"
																role="gridcell">CÔNG TY TNHH SES GROUP</td>
														</tr>
														<tr class="k-alt"
															data-uid="ea4a6378-536c-495d-b30e-16038bfd2201"
															role="row">
															<td class="table-cell" style="text-align: right;"
																role="gridcell">2</td>
															<td class="table-cell" style="text-align: center;"
																role="gridcell">Mã Sô Thuế</td>
															<td class="table-cell" style="text-align: center;"
																role="gridcell">0315382923</td>
														</tr>
														<tr data-uid="32da1104-e2a7-4496-80e6-03c33082469f"
															role="row">
															<td class="table-cell" style="text-align: right;"
																role="gridcell">3</td>
															<td class="table-cell" style="text-align: center;"
																role="gridcell">Người Đại Diện</td>
															<td class="table-cell" style="text-align: center;"
																role="gridcell">NGUYỄN HOÀNG GIANG</td>
														</tr>
														<tr class="k-alt"
															data-uid="65367b3b-d5ad-4618-a65a-07aab21e2103"
															role="row">
															<td class="table-cell" style="text-align: right;"
																role="gridcell">4</td>
															<td class="table-cell" style="text-align: center;"
																role="gridcell">Chức Vụ</td>
															<td class="table-cell" style="text-align: center;"
																role="gridcell">GIÁM ĐỐC</td>
														</tr>
														<tr data-uid="c704b977-99d8-47bd-8bf9-8598d507bbba"
															role="row">
															<td class="table-cell" style="text-align: right;"
																role="gridcell">5</td>
															<td class="table-cell" style="text-align: center;"
																role="gridcell">Số Tài Khoản</td>
															<td class="table-cell" style="text-align: center;"
																role="gridcell">88888888</td>
														</tr>
														<tr class="k-alt" data-uid="65367b3b-d5ad-4618-a65a-07aab21e2102"
															role="row">
															<td class="table-cell" style="text-align: right;"
																role="gridcell">6</td>
															<td class="table-cell" style="text-align: center;"
																role="gridcell">Tại Ngân Hàng</td>
															<td class="table-cell" style="text-align: center;"
																role="gridcell">Ngân hàng thương mại cổ phần Á Châu</td>
														</tr>
															<tr data-uid="65367b3b-d5ad-4618-a65a-07aab21e2102"
															role="row">
															<td class="table-cell" style="text-align: right;"
																role="gridcell">7</td>
															<td class="table-cell" style="text-align: center;"
																role="gridcell">Địa Chỉ Giao Dịch</td>
															<td class="table-cell" style="text-align: center;"
																role="gridcell">110 Bạch Đằng, Phường 2, Quận Tân Bình, TP.Hồ Chí Minh</td>
														</tr>
														<tr class="k-alt" data-uid="65367b3b-d5ad-4618-a65a-07aab21e2102"
															role="row">
															<td class="table-cell" style="text-align: right;"
																role="gridcell">8</td>
															<td class="table-cell" style="text-align: center;"
																role="gridcell">Địa Chỉ Xuất Hóa Đơn</td>
														<td class="table-cell" style="text-align: center;"
																role="gridcell">110 Bạch Đằng, Phường 2, Quận Tân Bình, TP.Hồ Chí Minh</td>
														</tr>
															<tr data-uid="65367b3b-d5ad-4618-a65a-07aab21e2102"
															role="row">
															<td class="table-cell" style="text-align: right;"
																role="gridcell">9</td>
															<td class="table-cell" style="text-align: center;"
																role="gridcell">Điện Thoại</td>
															<td class="table-cell" style="text-align: center;"
																role="gridcell">0888 966 668</td>
														</tr>
															<tr class="k-alt" data-uid="65367b3b-d5ad-4618-a65a-07aab21e2102"
															role="row">
															<td class="table-cell" style="text-align: right;"
																role="gridcell">10</td>
															<td class="table-cell" style="text-align: center;"
																role="gridcell">Email</td>
															<td class="table-cell" style="text-align: center;"
																role="gridcell">info@sesgroup.vn</td>
														</tr>
														
														<tr class="k-alt" data-uid="65367b3b-d5ad-4618-a65a-07aab21e2102"
															role="row">
															<td class="table-cell" style="text-align: right;"
																role="gridcell">11</td>
															<td class="table-cell" style="text-align: center;"
																role="gridcell">Hotline</td>
															<td class="table-cell" style="text-align: center;"
																role="gridcell">0888 966 668</td>
														</tr>
													</tbody>
												</table>
											</div>
										<div class="k-pager-wrap k-grid-pager k-widget k-floatwrap"
												data-role="pager">
												<span class="k-pager-info k-label">1 - 12 of 12 items</span>
											</div>
											
										
											
											
											
											
											
											
											
											
										</div>
									</div>
								</div>
							</div>

							<div class="row">
								<div class="col-12">
									<hr style="margin: 0 0 10px 0" />
								</div>
							</div>
							<div class="row mT-0 mB-5">
								<div class="col-9 col-sm-6 p-t-8">
									<span
										class="color-ses text-middle fw-800 text-uppercase text-decoration-underline">DANH
										MỤC DỊCH VỤ * </span>
								</div>
								<div class="col-3 col-sm-6 text-right">
									<button type="button" data-action="add-to-grid"
										id="btAddToGrid" class="btn-sm btn-primary btn-ses"
										title="Thêm sản phẩm">
										<i class="mdi mdi-plus fs-15"></i>
									</button>
								</div>
							</div>
							<div class="col-12 p-0 has-min-height-grid-prd">
								<div id="grid" data-role="grid" class="k-grid k-widget" style=""></div>
							</div>
		
							<div class="row m-t-16">
								<div class="col-12 col-sm-12 col-md-6"></div>
								<div class="col-12 col-sm-12 col-md-6">
									<div class="row m-b-16">
										<div class="col-12">
											<div class="c-f__wrapper">
												<input class="form-control form-control-sm c-f__textbox"
											th:value="${TgTCThue}" th:readonly="${!_isedit_}"	id="tong-tien-truoc-thue" name="tong-tien-truoc-thue"	type="text" autocomplete="off" readonly />
												<fieldset aria-hidden="true" class="c-f__set">
													<legend class="c-f__legend">
														<label>Tổng
															tiền trước thuế</label>
													</legend>
												</fieldset>
											</div>
										</div>
									</div>
									
									<div class="row m-b-16">
										<div class="col-12">
											<div class="c-f__wrapper">
												<input class="form-control form-control-sm c-f__textbox"
											th:value="${TgTThue}" th:readonly="${!_isedit_}" 	id="tong-tien-thue-gtgt" name="tong-tien-thue-gtgt" type="text" autocomplete="off" />
												<fieldset aria-hidden="true" class="c-f__set">
													<legend class="c-f__legend">
														<label>Tổng tiền thuế (VNĐ)</label>
													</legend>
												</fieldset>
											</div>
										</div>
									</div>
									<div class="row m-b-16">
										<div class="col-12">
											<div class="c-f__wrapper">
												<input class="form-control form-control-sm c-f__textbox"
										th:value="${TgTTTBSo}" th:readonly="${!_isedit_}"	id="tong-tien-da-co-thue" name="tong-tien-da-co-thue" 	type="text" autocomplete="off" readonly />
												<fieldset aria-hidden="true" class="c-f__set">
													<legend class="c-f__legend">
														<label>Tổng tiền đã có thuế</label>
													</legend>
												</fieldset>
											</div>
										</div>
									</div>
								</div>
							</div>
							<div class="row">
								<div class="col-md-12">
									<div class="row m-b-16">
										<div class="col-12">
											<div class="c-f__wrapper">
												<input class="form-control form-control-sm c-f__textbox"
											th:value="${TgTTTBChu}" th:readonly="${!_isedit_}"	id="tien-bang-chu" name="tien-bang-chu"	type="text" autocomplete="off" />
												<fieldset aria-hidden="true" class="c-f__set">
													<legend class="c-f__legend">
														<label>Số tiền viết bằng chữ</label>
													</legend>
												</fieldset>
											</div>
										</div>
									</div>
								</div>
							</div>

							<div class="row">
								<div class="col-12">
									<hr style="margin: 0 0 10px 0" />
								</div>
							</div>
							<div class="row m-b-6">
								<div class="col-6">
									<button type="button" id="btBack" title="Quay lại"
									data-action="back"	class="btn btn-sm btn-primary btn-ses">
										Quay lại</button>
								</div>
								<div class="col-6 text-right">
									<button type="button" id="btAccept"
										data-action="accept" class="btn btn-sm btn-primary btn-ses" title="Chấp nhận"	th:if="${null == messageError && ('CREATE' == _action_ || 'EDIT' == _action_)}">
										Chấp nhận</button>
								</div>
							</div>
					
						</div>
					</div>
					<input type="hidden" name="_id" th:value="${_id}" >
						<input type="hidden" name="cv" th:value="${Position}" >
							<input type="hidden" name="e" th:value="${Email}" >
								<input type="hidden" name="w" th:value="${Website}" >
									<input type="hidden" name="ac" th:value="${AccountNumber}" >
										<input type="hidden" name="an" th:value="${AccountName}" >
											<input type="hidden" name="bn" th:value="${BankName}" >
			
			</form>
			<script type="text/javascript">
				transactionMain = 'issu-contract-cre'
				var rowsTMP = []
				var vIsEdit = true
				_gridSub01 = $('#f-issu-contract-crud').find('#grid')
				_gridSub01A = $('#f-issu-contract-crud').find('#gridA')
				_gridSub01B = $('#f-issu-contract-crud').find('#gridB')
			</script>

	<script type="text/javascript">
		transactionMain = '[[${transaction}]]';
		var rowsTMP = [];
		var vIsEdit = [[${_isedit_}]];
		_gridSub01 = $('#f-issu-contract-crud').find('#grid');
		</script>
		
		<script type="text/javascript" th:if="${_action_ == 'CREATE' && false}"></script>
		<script type="text/javascript" th:if="${null == DSHHDVu}">
		$.each(new Array(3),
			function(n){
				rowsTMP.push({});
			}
		);
		</script>
		<script type="text/javascript" th:if="${null != DSHHDVu}">
		var strJson = '[[${DSHHDVu}]]';
		rowsTMP = [];
		try{
			rowsTMP = decodeBase64UTF8ToObj(strJson);
		}catch(err){}
		</script>


		</div>
	
			<script type="text/javascript">
				transactionMain = 'issu-contract-cre'
				var rowsTMP = []
				var vIsEdit = true
				_gridSub01 = $('#f-issu-contract-crud').find('#grid')
				_gridSub01A = $('#f-issu-contract-crud').find('#gridA')
				_gridSub01B = $('#f-issu-contract-crud').find('#gridB')
			</script>

	<script type="text/javascript">
		transactionMain = '[[${transaction}]]';
		var rowsTMP = [];
		var vIsEdit = [[${_isedit_}]];
		_gridSub01 = $('#f-issu-contract-crud').find('#grid');
		</script>
		
		<script type="text/javascript" th:if="${_action_ == 'CREATE' && false}"></script>
		<script type="text/javascript" th:if="${null == DSHHDVu}">
		$.each(new Array(3),
			function(n){
				rowsTMP.push({});
			}
		);
		</script>
		<script type="text/javascript" th:if="${null != DSHHDVu}">
		var strJson = '[[${DSHHDVu}]]';
		rowsTMP = [];
		try{
			rowsTMP = decodeBase64UTF8ToObj(strJson);
		}catch(err){}
		</script>


		</div>
	</div>
</div>
</html>